tmp<-tempfile(fileext=".xlsx")
download.file("https://github.com/MEF-BDA503/gpj18-data-jugglers/blob/master/XU030_v2.xlsx?raw=true",destfile=tmp,mode='wb')
library(readxl)
bist30=read_xlsx(tmp)
str(bist30)
library(date)
install.packages("date")
bist30
bist30
corrValues <- bist30 <- cbind(bist30, apply(bist30[seq(2,62,90)], 2, cor)
corrValues <- cbind(bist30, apply(bist30[seq(2,62,90)], 2, cor)
corrValues <- cbind(bist30, apply(bist30[seq(2,62,90)], 2, cor))
corrValues <- cbind(bist30, apply(bist30[seq(2,62,90)], 2, corr))
corrValues <- cbind(bist30, apply(bist30[seq(2,62,90)], 2, cor))
corrValues <- cbind(bist30, sapply(bist30[seq(2,62,90)], 2, cor))
corrValues <- cbind(bist30, apply(bist30[seq(2,62,90)], 2, cor))
cor(bist[2:30],bist[30:60])
cor(bist30[2:30],bist30[30:60])
cor(bist30[2:60],bist30[30:60])
library(corrgram)
install.packages("corrgram")
corrValuesTable <- cor(bist30[2:60],bist30[30:60])
corrValuesTable <- cor(bist30[2:60],bist30[30:60])
corrgram(corrValuesTable,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Car Milage Data in PC2/PC1 Order"))
corrValuesTable <- cor(bist30[2:60],bist30[30:60])
corrgram(corrValuesTable,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Correlation Data in Volume-Price Order"))
corrValuesTable <- cor(bist30[2:60],bist30[30:60])
corrgram(corrValuesTable,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Correlation Data in Volume-Price Order")
library(corrgram)
corrValuesTable <- cor(bist30[2:60],bist30[30:60])
corrgram(corrValuesTable,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Correlation Data in Volume-Price Order")
library(corrgram)
library(corrplot)
corrplot(corrValuesTable,method = "circle")
corrplot(corrValuesTable,method = "square")
corrplot(corrValuesTable,method = "upper")
corrplot.mixed(corrValuesTable, lower.col = "black", number.cex = .7)
corrplot(corrValuesTable,method = "square")
tmp<-tempfile(fileext=".xlsx")
download.file("https://github.com/MEF-BDA503/gpj18-data-jugglers/blob/master/XU030_v2.xlsx?raw=true",destfile=tmp,mode='wb')
library(readxl)
bist30=read_xlsx(tmp)
str(bist30)
library(date)
as.Date(bist30$Dates,format="%y-%m-%d")
str(bist30$Dates)
range(bist30$Dates)
head(bist30)
tail(bist30)
corrValuesTable <- cor(bist30[2:60],bist30[2:60])
corrgram(corrValuesTable,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Correlation Data in Volume-Price Order")
bistCorr30 <- bist30[2:60]
corrValuesTable <- cor(bist30[2:60],bist30[2:60])
corrgram(corrValuesTable,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Correlation Data in Volume-Price Order")
bistCorr30 <- bist30[1:60]
corrValuesTable <- cor(bist30[2:60],bist30[2:60])
corrgram(corrValuesTable,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Correlation Data in Volume-Price Order")
View(bistCorr30)
View(bistCorr30)
View(bistCorr30)
View(bist30)
View(bistCorr30)
bistCorr30 <- bist30[2:60]
corrValuesTable <- cor(bist30[2:60],bist30[2:60])
corrgram(corrValuesTable,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Correlation Data in Volume-Price Order")
View(bistCorr30)
tmp<-tempfile(fileext=".xlsx")
download.file("https://github.com/MEF-BDA503/gpj18-data-jugglers/blob/master/XU030_v2.xlsx?raw=true",destfile=tmp,mode='wb')
library(readxl)
bist30=read_xlsx(tmp)
bist30 <- cbind(bist30, apply(bist30[seq(2,60,2)], 2, function (a) a / a[[1]] * 100))
colnames(bist30)[62:91] <- paste(colnames(bist30[seq(2,60,2)]), "norm", sep = "_")
head(bist30[62:90],10)
View(bist30)
bistCorr30 <- bist30[62:90]
corrValuesTable <- cor(bist30[2:60],bist30[2:60])
corrgram(corrValuesTable,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Correlation Data in Volume-Price Order")
bistCorr30 <- bist30[62:90]
corrValuesTable <- cor(bist30[62:90],bist30[62:90])
corrgram(corrValuesTable,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Correlation Data in Volume-Price Order")
# generating large feature matrix (cols=features, rows=samples)
num_features <- 29 # how many features
num_samples <- 2056 # how many samples
DATASET <- matrix(runif(num_features * num_samples),
nrow = num_samples, ncol = num_features)
# setting some dummy names for the features e.g. f23
colnames(DATASET) <- paste0("f", 1:ncol(DATASET))
# let's make 30% of all features to be correlated with feature "f1"
num_feat_corr <- num_features * .3
idx_correlated_features <- as.integer(seq(from = 1,
to = num_features,
length.out = num_feat_corr))[-1]
for (i in idx_correlated_features) {
DATASET[,i] <- DATASET[,1] + runif(num_samples) # adding some noise
}
corrplot(cor(DATASET), diag = FALSE, order = "FPC",
tl.pos = "td", tl.cex = 0.5, method = "color", type = "upper")
corrplot(corrValuesTable, method = "circle")
bistCorr30 <- bist30[2:60]
corrValuesTable <- cor(bist30[2:60],bist30[2:60])
corrgram(corrValuesTable,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Correlation Data in Price Order")
corrplot(corrValuesTable, method = "circle")
corrValuesPrices <- cor(bist30[62:90],bist30[62:90])
corrValuesPrices <- cor(bist30[62:90],bist30[62:90])
corrgram(corrValuesPrices,order=TRUE, lower.panel=panel.shade,
upper.panel=panel.pie, text.panel=panel.txt,
main="Correlation Data in Volume-Price Order")
corrplot(corrValuesPrices, method = "circle")
corrValuesPriceVolume <- apply(bist30[seq(2,60,2)], 2, cor)
corrValuesPriceVolume <- apply(bist30[seq(2,60,2)],bist30[seq(1,60,2)], 2, cor)
corrValuesPriceVolume <- apply(bist30[seq(2,60,2)], bist30[seq(1,60,2)], cor)
corrValuesPriceVolume <- apply(bist30[seq(1,60,2)], bist30[seq(2,60,2)], cor)
corrValuesPriceVolume <- apply(list(bist30[seq(1,60,2)], bist30[seq(2,60,2)]), cor)
corrValuesPriceVolume <- apply(list(bist30[seq(1,60,2)], bist30[seq(2,60,2)]), cor)
d2 <- bist30 %>%
as.matrix %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
library(tibble)
library(dplyr)
library(tidyr)
library(tibble)
library(dplyr)
d2 <- bist30 %>%
as.matrix %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
d2 <- bist30[2,60] %>%
as.matrix %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
d2 <- bist30[2,60] %>%
as.matrix %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
d2
d2 <- bist30[2,92] %>%
as.matrix %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
d2 <- bist30[2,90] %>%
as.matrix %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
d2
install.packages(c('tibble', 'dplyr', 'tidyr'))
library(tibble)
library(dplyr)
install.packages(c("tibble", "dplyr", "tidyr"))
install.packages(c("tibble", "dplyr", "tidyr"))
install.packages(c("tibble", "dplyr", "tidyr"))
install.packages(c("tibble", "dplyr", "tidyr"))
library(tibble)
install.packages("tibble")
library(tibble)
install.packages("tibble")
install.packages("tibble")
library(tibble)
install.packages("tibble")
library(tibble)
library(dplyr)
library(tibble)
library(dplyr)
install.packages("dplyr")
library(tibble)
library(dplyr)
library(tidyr)
library(tibble)
library(dplyr)
library(tidyr)
d2 <- bist30[2,90] %>%
as.matrix %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
d2
d2 <- bist30[2,90] %>%
cor %>%
d2 <- bist30[2,90] %>%
cor
d2 <- bist30[2,90] %>%
cor %>%
as.data.frame
d2 <- bist30[2,90] %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
d2 <- bist30[2,90] %>%
as.matrix %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
d2
d2 <- bist30[2,90] %>%
as.matrix %>%
cor
d2
d2 <- bist30[2,15] %>%
as.matrix %>%
cor
d2
d <- data.frame(x1=rnorm(10),
x2=rnorm(10),
x3=rnorm(10))
d2 <- d %>%
as.matrix %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
d <- data.frame(x1=rnorm(10),
x2=rnorm(10),
x3=rnorm(10))
d2 <- d %>%
as.matrix %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
d2
d <- data.frame(bist30[2,60])
d2 <- d %>%
as.matrix %>%
cor %>%
as.data.frame %>%
rownames_to_column(var = 'var1') %>%
gather(var2, value, -var1)
d2
df <- bist30
corGaran <- cor(df$GARAN_Price,df$GARAN_Volume)
corSahol <- cor(df$SAHOL_Price,df$SAHOL_Volume)
corBimas <- cor(df$BIMAS_Price,df$BIMAS_Volume)
corArclk <- cor(df$ARCLK_Price,df$ARCLK_Volume)
corEregl <- cor(df$EREGL_Price,df$EREGL_Volume)
corYkbnk <- cor(df$YKBNK._Price,df$YKBNK._Volume)
df <- bist30
corGaran <- cor(df$GARAN_Price,df$GARAN_Volume)
corSahol <- cor(df$SAHOL_Price,df$SAHOL_Volume)
corBimas <- cor(df$BIMAS_Price,df$BIMAS_Volume)
corArclk <- cor(df$ARCLK_Price,df$ARCLK_Volume)
corEregl <- cor(df$EREGL_Price,df$EREGL_Volume)
corYkbnk <- cor(df$YKBNK._Price,df$YKBNK._Volume)
df <- bist30
corGaran <- cor(df$GARAN_Price,df$GARAN_Volume)
corSahol <- cor(df$SAHOL_Price,df$SAHOL_Volume)
corBimas <- cor(df$BIMAS_Price,df$BIMAS_Volume)
corArclk <- cor(df$ARCLK_Price,df$ARCLK_Volume)
corEregl <- cor(df$EREGL_Price,df$EREGL_Volume)
corYkbnk <- cor(df$`YKBNK _Price`,df$`YKBNK _Volume`)
corToaso <- cor(df$TOASO_Price,df$TOASO_Volume)
corTuprs <- cor(df$TUPRS_Price,df$TUPRS_Volume)
corKrdmd <- cor(df$KRDMD_Price,df$KRDMD_Volume)
corTtrak <- cor(df$TTRAK_Price,df$TTKOM_Volume)
corAsels <- cor(df$ASELS_Price,df$ASELS_Volume)
corIpeke <- cor(df$IPEKE_Price,df$IPEKE_Volume)
corKozaa <- cor(df$KOZAA_Price,df$KOZAA_Volume)
corAsyab <- cor(df$ASYAB_Price,df$ASYAB_Volume)
corEnkai <- cor(df$ENKAI_Price,df$ENKAI_Volume)
corKozal <- cor(df$KOZAL_Price,df$KOZAL_Volume)
corDohol <- cor(df$DOHOL_Price,df$DOHOL_Volume)
corIhlas <- cor(df$IHLAS_Price,df$IHLAS_Volume)
corKchol <- cor(df$KCHOL_Price,df$KCHOL_Volume)
corEgkyo <- cor(df$EKGYO_Price,df$EKGYO_Volume)
corTcell <- cor(df$TCELL_Price,df$TCELL_Volume)
corMgros <- cor(df$MGROS_Price,df$MGROS_Volume)
corSise <- cor(df$SISE_Price,df$SISE_Volume)
corIsctr <- cor(df$ISCTR_Price,df$ISCTR_Volume)
corVakbn <- cor(df$VAKBN_Price,df$VAKBN_Volume)
corAkbnk <- cor(df$AKBNK_Price,df$AKBNK_Volume)
corPetkm <- cor(df$PETKM_Price,df$PETKM_Volume)
corThyao <- cor(df$THYAO_Price,df$THYAO_Volume)
corTtkom <- cor(df$TTKOM_Price,df$TTKOM_Volume)
corHalkb <- cor(df$HALKB_Price,df$HALKB_Volume)
corVec <- c(corGaran,corSahol,corBimas,corArclk,corEregl,corYkbnk,corToaso,corTuprs,corKrdmd,corTtrak,corAsels,corIpeke,corKozaa,corAsyab,corEnkai,corKozal,corDohol,corIhlas,corKchol,corEgkyo,corTcell,corMgros,corSise,corIsctr,corVakbn,corAkbnk,corPetkm,corThyao,corTtkom,corHalkb )
companyNames <- c('GARAN','SAHOL','BIMAS','ARCLK','EREGL','YKBNK','TOASO','TUPRS','KRDMD','TTRAK','ASELS','IPEKE','KOZAA','ASYAB','ENKAI','KOZAL','DOHOL','IHLAS','KCHOL','EKGYO','TCELL','MGROS','SISE','ISCTR','VAKBN','AKBNK','PETKM','THYAO','TTKOM','HALKB')
corrTable$variable <- NULL
corrTable <- melt(data.frame(companyNames ,corVec))
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
corrTable <- melt(data.frame(companyNames ,corVec))
corrTable$variable <- NULL
corrTable
theme_set(theme_bw())
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(ggplot2)
theme_set(theme_bw())
corrTable %>% arrange(desc(value)) %>%
ggplot( aes(x=companyNames, y=value)) +
geom_bar(stat="identity", width=.5, fill="tomato3") +
labs(title="Ordered Bar Chart",
subtitle="Correlation Values",
caption="Correlation graph") +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
corrTable %>% arrange(desc(abs(value)))
corrplot(corrValuesTable, method = "circle") +  theme(axis.text.x = element_text(angle=65, vjust=0.6))
corrplot(corrValuesTable, method = "circle",cl.pos = "b", tl.pos = "d", tl.srt = 60)
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(corrgram)
library(corrplot)
corrplot(corrValuesTable, method = "circle",cl.pos = "b", tl.pos = "d", tl.srt = 60)
corrplot(corrValuesTable, method = "circle",order = "hclust", tl.col = "black", tl.srt = 45)
corrplot(corrValuesTable, type = "upper", tl.pos = "td",
method = "circle", tl.cex = 0.5, tl.col = 'black',
order = "hclust", diag = FALSE))
corrplot(corrValuesTable, type = "upper", tl.pos = "td",
method = "circle", tl.cex = 0.5, tl.col = 'black',
order = "hclust", diag = FALSE)
corrplot(corrValuesPrices, type = "upper", tl.pos = "td",
method = "circle", tl.cex = 0.5, tl.col = 'black',
order = "hclust", diag = FALSE))
corrplot(corrValuesPrices, type = "upper", tl.pos = "td",
method = "circle", tl.cex = 0.5, tl.col = 'black',
order = "hclust", diag = FALSE)
