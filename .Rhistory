filter(cor < -0.4) %>%
ggplot( aes(x=Names, y=cor)) +
geom_bar(stat="identity", width=.5, fill="tomato3") +
labs(title="Ordered Bar Chart",
subtitle="Correlation Values",
caption="Correlation graph") +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
theme_set(theme_economist())
generalCorData %>% arrange(desc(cor)) %>%
filter(cor < -0.7) %>%
ggplot( aes(x=Names, y=cor)) +
geom_bar(stat="identity", width=.5, fill="tomato3") +
labs(title="Ordered Bar Chart",
subtitle="Correlation Values",
caption="Correlation graph") +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
theme_set(theme_economist())
generalCorData %>% arrange(desc(cor)) %>%
filter(cor < -0.8) %>%
ggplot( aes(x=Names, y=cor)) +
geom_bar(stat="identity", width=.5, fill="tomato3") +
labs(title="Ordered Bar Chart",
subtitle="Correlation Values",
caption="Correlation graph") +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
theme_set(theme_economist())
generalCorData %>% arrange(desc(cor)) %>%
filter(cor < -0.75) %>%
ggplot( aes(x=Names, y=cor)) +
geom_bar(stat="identity", width=.5, fill="tomato3") +
labs(title="Ordered Bar Chart",
subtitle="Correlation Values",
caption="Correlation graph") +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
theme_set(theme_economist())
generalCorData %>% arrange(desc(cor)) %>%
filter(cor < -0.7) %>%
ggplot( aes(x=Names, y=cor)) +
geom_bar(stat="identity", width=.5, fill="tomato3") +
labs(title="Ordered Bar Chart",
subtitle="Correlation Values",
caption="Correlation graph") +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
theme_set(theme_economist())
generalCorData %>% arrange(desc(cor)) %>%
filter(cor < -0.72) %>%
ggplot( aes(x=Names, y=cor)) +
geom_bar(stat="identity", width=.5, fill="tomato3") +
labs(title="Ordered Bar Chart",
subtitle="Correlation Values",
caption="Correlation graph") +
theme(axis.text.x = element_text(angle=65, vjust=0.6))
ggpairs(df,
columns = c("ASYAB_Price","KCHOL_Price","BIMAS_Price","TTRAK_Price","TOASO_Price","IHLAS_Price"),
upper = list(continuous = wrap("cor",
size = 10)),
lower = list(continuous = "smooth"))
grid.arrange(g1,
g2,
g3,
g4,
g5,
nrow=5)
g1 <- ggplot(df, aes(df$ASYAB_Price, df$KCHOL_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
g2 <- ggplot(df, aes(df$ASYAB_Price, df$BIMAS_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
g4 <- ggplot(df, aes(df$ASYAB_Price, df$TOASO_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
g5 <- ggplot(df, aes(df$TTRAK_Price, df$IHLAS_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
grid.arrange(g1,
g2,
g3,
g4,
g5,
nrow=5)
grid.arrange(g1,
g2,
g3,
g4,
g5,
nrow=5)
g5 <- ggplot(df, aes(df$TTRAK_Price, df$IHLAS_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
grid.arrange(g1,
g2,
g3,
g4,
g5,
nrow=5)
g5 <- ggplot(df, aes(df$TTRAK_Price, df$IHLAS_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
g5 <- ggplot(df, aes(df$TTRAK_Price, df$IHLAS_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
g5
grid.arrange(p1,
p2,
p3,
p4,
p5,
nrow=5)
p1 <- ggplot(df, aes(df$ASYAB_Price, df$KCHOL_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
p2 <- ggplot(df, aes(df$ASYAB_Price, df$BIMAS_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
p3 <- ggplot(df, aes(df$ASYAB_Price, df$TTRAK_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
p4 <- ggplot(df, aes(df$ASYAB_Price, df$TOASO_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
p5 <- ggplot(df, aes(df$TTRAK_Price, df$IHLAS_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
grid.arrange(p1,
p2,
p3,
p4,
p5,
nrow=5)
grid.arrange(p1,
p2,
p3,
p4,
p5,
nrow=5)
p5 <- ggplot(df, aes(df$TTRAK_Price, df$IHLAS_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
p5
grid.arrange(p1,
p2,
p3,
p4,
p5,
nrow=5)
ggplot(df, aes(df$TTRAK_Price, df$IHLAS_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
ggplot(df, aes(df$ASYAB_Price, df$KCHOL_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
ggplot(df, aes(df$ASYAB_Price, df$BIMAS_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
selectedComp2 <-  as.data.frame(t(selectedComp2))
selectedComp1 <-  as.data.frame(t(selectedComp1))
totalComp <- as.data.frame(t(totalComp))
names(selectedComp2) <- bist30$Dates
selectedComp2 <-  as.data.frame(t(selectedComp2))
selectedComp1 <-  as.data.frame(t(selectedComp1))
totalComp <- as.data.frame(t(totalComp))
names(selectedComp2) <- bist30$Dates
names(selectedComp1) <- bist30$Dates
names(totalComp) <- bist30$Dates
selectedComp1
knitr::opts_chunk$set(echo = T,
results = "hide")
library(ggthemes)
library(Hmisc)
library(gridExtra)
library(GGally)
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(corrgram)
library(corrplot)
library(date)
library(readxl)
library(knitr)
prices <- df1[0:61] %>%
select(matches("price"))
volumes <- df2[0:61] %>%
select(matches("Volume"))
prices <- df1[0:61] %>%
select(matches("price"))
volumes <- df2[0:61] %>%
select(matches("Volume"))
priceVolumeProduct <- prices * volumes
volumeSums <- volumes %>% summarise_at(names(volumes), mean, na.rm = TRUE)
volumeSums <- volumes %>% summarise_at(names(volumes), mean, na.rm = TRUE)
volumeSums
volumeSums <- volumes %>% summarise_at(names(volumes), mean, na.rm = TRUE)
TotalVolume <- rowsum(volumeSums)
volumeSums <- volumes %>% summarise_at(names(volumes), mean, na.rm = TRUE)
TotalVolume <- rowSums(volumeSums)
volumeSums <- volumes %>% summarise_at(names(volumes), mean, na.rm = TRUE)
TotalVolume <- rowSums(volumeSums)
TotalVolume
weigthedAverage <- priceVolumeProduct / TotalVolume
weigthedAverage <- priceVolumeProduct / TotalVolume
weigthedAverage
weigthedAverage <- paste(colnames(weigthedAverage), "weigthedAvg", sep = "_")
weigthedAverage <- paste(colnames(weigthedAverage), "weigthedAvg", sep = "_")
weigthedAverage
colnames(weigthedAverage) <- paste(colnames(weigthedAverage), "weigthedAvg", sep = "_")
colnames(weigthedAverage) <- paste(colnames(companyNames), "weigthedAvg", sep = "_")
colnames(weigthedAverage) <- paste(colnames(companyNames), "weigthedAvg", sep = "_")
names(weigthedAverage) <- paste(colnames(companyNames), "weigthedAvg", sep = "_")
names(weigthedAverage) <- paste(colnames(companyNames), "weigthedAvg", sep = "_")
weigthedAverage
names(weigthedAverage) <- paste(colnames(companyNames), "weigthedAvg", sep = "_")
weigthedAverage
names(weigthedAverage) <- paste(colnames(companyNames), "weigthedAvg", sep = "_")
weigthedAverage
weigthedAverage <- priceVolumeProduct / TotalVolume
weigthedAverage
names(weigthedAverage) <- paste(colnames(companyNames), "weigthedAvg", sep = "_")
weigthedAverage
names(weigthedAverage) <- paste(names(companyNames), "weigthedAvg", sep = "_")
weigthedAverage
colnames(weigthedAverage) <- paste(colnames(companyNames), "weigthedAvg", sep = "_")
weigthedAverage
colnames(weigthedAverage) <- paste(companyNames,"wAvg",sep = "_")
weigthedAverage
names(bist30)
bankStocksAvg <- c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")
bankStocksAvg <- c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")
selectedComp1 <- newbist30[,bankStocks]
selectedComp2 <- newbist30[ , !(names(newbist30) %in% bankStocks)]
totalComp <- newbist30 %>% select(matches("_wAvg"))
selectedComp2
selectedComp1 <- weigthedAverage[,bankStocks]
selectedComp1 <- weigthedAverage[,bankStocksAvg]
selectedComp1 <- weigthedAverage[,bankStocksAvg]
selectedComp1 <- weigthedAverage[ ,bankStocksAvg]
selectedComp1 <- weigthedAverage[ ,bankStocksAvg]
selectedComp1 <- weigthedAverage[ ,bankStocksAvg]
selectedComp1 <- weigthedAverage[ ,bankStocksAvg]
group1 <- weigthedAverage[ ,bankStocksAvg]
mainGroup <- weigthedAverage[ ,bankStocksAvg]
mainGroup <- weigthedAverage[ ,bankStocksAvg]
bankStocksAvg <- c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")
mainGroup <- weigthedAverage[ ,bankStocksAvg]
colnames(weigthedAverage) <- paste(companyNames,"wAvg",sep = "_")
weigthedAverage
mainGroup <- weigthedAverage[,bankStocksAvg]
bankStocksAvg <- c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
bankStocksAvg <- c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")
mainGroup <- weigthedAverage[,bankStocksAvg]
newbist30 <- bist30[,62:91]
selectedComp1 <- newbist30[,bankStocks]
selectedComp2 <- newbist30[ , !(names(newbist30) %in% bankStocks)]
totalComp <- newbist30 %>% select(matches("norm"))
selectedComp2
prices <- df1[0:61] %>%
select(matches("price"))
volumes <- df2[0:61] %>%
select(matches("Volume"))
priceVolumeProduct <- prices * volumes
prices <- df1[0:61] %>%
select(matches("price"))
volumes <- df2[0:61] %>%
select(matches("Volume"))
priceVolumeProduct <- prices * volumes
priceVolumeProduct
str(bist30)
tmp<-tempfile(fileext=".xlsx")
download.file("https://github.com/MEF-BDA503/gpj18-data-jugglers/blob/master/XU030_v2.xlsx?raw=true",destfile=tmp,mode='wb')
bist30=read_xlsx(tmp)
as.Date(bist30$Dates,format="%y-%m-%d")
str(bist30$Dates)
range(bist30$Dates)
head(bist30)
tail(bist30)
prices <- df1[0:61] %>%
select(matches("price"))
volumes <- df2[0:61] %>%
select(matches("Volume"))
priceVolumeProduct <- prices * volumes
prices
prices <- bist30[0:61] %>%
select(matches("price"))
volumes <- bist30[0:61] %>%
select(matches("Volume"))
priceVolumeProduct <- prices * volumes
prices
prices <- bist30[0:61] %>%
select(matches("price"))
volumes <- bist30[0:61] %>%
select(matches("Volume"))
priceVolumeProduct <- prices * volumes
priceVolumeProduct
weigthedAverage <- priceVolumeProduct / TotalVolume
weigthedAverage
colnames(weigthedAverage) <- paste(companyNames,"wAvg",sep = "_")
weigthedAverage
bankStocksAvg <- c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,,bankStocksAvg]
mainGroup <- weigthedAverage[,,bankStocksAvg]
mainGroup <- weigthedAverage[bankStocksAvg]
mainGroup <- weigthedAverage[bankStocksAvg,]
mainGroup <- weigthedAverage[bankStocksAvg,]
mainGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
bankStocksAvg <- c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")
weigthedAverage <- as.data.frame(weightedAverage)
bankStocksAvg <- c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")
weigthedAverage <- as.data.frame(weigthedAverage)
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,c(2,4,3)
mainGroup <- weigthedAverage[,c(2,4,3)]
mainGroup <- weigthedAverage[,c(2,4,3)]
mainGroup
mainGroup <- weigthedAverage[,c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")]
mainGroup <- weigthedAverage[,c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")]
mainGroup <- weigthedAverage[,c(1,2,3,4,5,6,7)]
mainGroup
mainGroup <- weigthedAverage[,c(1,8,9,10,11,12,13)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,15,16,17,18,19)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,20,21,22,23,24)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,25,26,27,28,29)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,25,26,30,28,29)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,25,26,30,28)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,25,26,30)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,25,26,30,3)]
mainGroup
mainGroup <- weigthedAverage[,c(3,14,25,26,30,1)]
mainGroup
mainGroup <- weigthedAverage[,c(4,14,25,26,30,1)]
mainGroup
mainGroup <- weigthedAverage[,c(5,14,25,26,30,1)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,7)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,8)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,9)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,10)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,11)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,12)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,13)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,14)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,15)]
mainGroup
mainGroup <- weigthedAverage[,c(16,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(17,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(18,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(19,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(20,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(21,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(22,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(23,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(24,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
bankStocksAvg <- c(24,14,25,26,30,1,6)
bankStocksAvg <- c(24,14,25,26,30,1,6)
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , !(names(weigthedAverage) %in% bankStocks)]
totalComp <- newbist30 %>% select(matches("norm"))
selectedComp2
mainGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , !(names(weigthedAverage) %in% bankStocks)]
totalComp <- newbist30 %>% select(matches("norm"))
selectedComp2
otherGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , -bankStocks)]
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , -bankStocks]
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , -(bankStocks)]
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalComp <- newbist30 %>% select(matches("norm"))
selectedComp2
otherGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalComp <- newbist30 %>% select(matches("wAvg"))
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
colSums(mainGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
rowSums(mainGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
maingroup$Avg <- rowSums(mainGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSum(totalGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
totalGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
otherGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
totalGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- weigthedAverage %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- weigthedAverage %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- weigthedAverage %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
totalGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- weigthedAverage %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
WAvgTable <- data.frame(bist30$Dates,mainGroup$Avg,otherGroup$Avg,totalGroup$Avg )
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- weigthedAverage %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
WAvgTable <- data.frame(bist30$Dates,mainGroup$Avg,otherGroup$Avg,totalGroup$Avg )
WAvgTable
ggplot(WAvgTable, aes(x = bist30.Dates)) +
geom_line(aes(y = mainGroup.Avg, colour = "mainGroup.Avg")) +
geom_line(aes(y = otherGroup.Avg, colour = "otherGroup.Avg")) +
geom_line(aes(y = totalGroup.Avg, colour = "totalGroup.Avg")) +
xlab("Years") + ylab("Weighted Prices")
theme_set(theme_economist())
