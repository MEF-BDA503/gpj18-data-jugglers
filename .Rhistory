str(bist30$Dates)
range(bist30$Dates)
head(bist30)
tail(bist30)
prices <- df1[0:61] %>%
select(matches("price"))
volumes <- df2[0:61] %>%
select(matches("Volume"))
priceVolumeProduct <- prices * volumes
prices
prices <- bist30[0:61] %>%
select(matches("price"))
volumes <- bist30[0:61] %>%
select(matches("Volume"))
priceVolumeProduct <- prices * volumes
prices
prices <- bist30[0:61] %>%
select(matches("price"))
volumes <- bist30[0:61] %>%
select(matches("Volume"))
priceVolumeProduct <- prices * volumes
priceVolumeProduct
weigthedAverage <- priceVolumeProduct / TotalVolume
weigthedAverage
colnames(weigthedAverage) <- paste(companyNames,"wAvg",sep = "_")
weigthedAverage
bankStocksAvg <- c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,,bankStocksAvg]
mainGroup <- weigthedAverage[,,bankStocksAvg]
mainGroup <- weigthedAverage[bankStocksAvg]
mainGroup <- weigthedAverage[bankStocksAvg,]
mainGroup <- weigthedAverage[bankStocksAvg,]
mainGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
bankStocksAvg <- c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")
weigthedAverage <- as.data.frame(weightedAverage)
bankStocksAvg <- c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")
weigthedAverage <- as.data.frame(weigthedAverage)
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,c(2,4,3)
mainGroup <- weigthedAverage[,c(2,4,3)]
mainGroup <- weigthedAverage[,c(2,4,3)]
mainGroup
mainGroup <- weigthedAverage[,c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")]
mainGroup <- weigthedAverage[,c("GARAN_wAvg","VAKBN_wAvg","AKBNK_wAvg","YKBNK _wAvg","ASYAB_wAvg","HALKB_wAvg","ISCTR_wAvg")]
mainGroup <- weigthedAverage[,c(1,2,3,4,5,6,7)]
mainGroup
mainGroup <- weigthedAverage[,c(1,8,9,10,11,12,13)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,15,16,17,18,19)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,20,21,22,23,24)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,25,26,27,28,29)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,25,26,30,28,29)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,25,26,30,28)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,25,26,30)]
mainGroup
mainGroup <- weigthedAverage[,c(1,14,25,26,30,3)]
mainGroup
mainGroup <- weigthedAverage[,c(3,14,25,26,30,1)]
mainGroup
mainGroup <- weigthedAverage[,c(4,14,25,26,30,1)]
mainGroup
mainGroup <- weigthedAverage[,c(5,14,25,26,30,1)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,7)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,8)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,9)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,10)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,11)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,12)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,13)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,14)]
mainGroup
mainGroup <- weigthedAverage[,c(6,14,25,26,30,1,15)]
mainGroup
mainGroup <- weigthedAverage[,c(16,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(17,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(18,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(19,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(20,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(21,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(22,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(23,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,c(24,14,25,26,30,1,6)]
mainGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup <- weigthedAverage[,bankStocksAvg]
bankStocksAvg <- c(24,14,25,26,30,1,6)
bankStocksAvg <- c(24,14,25,26,30,1,6)
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
mainGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , !(names(weigthedAverage) %in% bankStocks)]
totalComp <- newbist30 %>% select(matches("norm"))
selectedComp2
mainGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , !(names(weigthedAverage) %in% bankStocks)]
totalComp <- newbist30 %>% select(matches("norm"))
selectedComp2
otherGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , -bankStocks)]
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , -bankStocks]
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , -(bankStocks)]
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalComp <- newbist30 %>% select(matches("norm"))
selectedComp2
otherGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalComp <- newbist30 %>% select(matches("wAvg"))
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
colSums(mainGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
rowSums(mainGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
maingroup$Avg <- rowSums(mainGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSum(totalGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
totalGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
otherGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- newbist30 %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
totalGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- weigthedAverage %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- weigthedAverage %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- weigthedAverage %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
totalGroup
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- weigthedAverage %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
WAvgTable <- data.frame(bist30$Dates,mainGroup$Avg,otherGroup$Avg,totalGroup$Avg )
mainGroup <- weigthedAverage[,bankStocksAvg]
otherGroup <- weigthedAverage[ , c(-24,-14,-25,-26,-30,-1,-6)]
totalGroup <- weigthedAverage %>% select(matches("wAvg"))
mainGroup$Avg <- rowSums(mainGroup)
otherGroup$Avg <- rowSums(otherGroup)
totalGroup$Avg <- rowSums(totalGroup)
WAvgTable <- data.frame(bist30$Dates,mainGroup$Avg,otherGroup$Avg,totalGroup$Avg )
WAvgTable
ggplot(WAvgTable, aes(x = bist30.Dates)) +
geom_line(aes(y = mainGroup.Avg, colour = "mainGroup.Avg")) +
geom_line(aes(y = otherGroup.Avg, colour = "otherGroup.Avg")) +
geom_line(aes(y = totalGroup.Avg, colour = "totalGroup.Avg")) +
xlab("Years") + ylab("Weighted Prices")
theme_set(theme_economist())
knitr::opts_chunk$set(echo = T,
results = "hide")
library(ggthemes)
library(Hmisc)
library(gridExtra)
library(GGally)
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(corrgram)
library(corrplot)
library(date)
library(readxl)
library(knitr)
ggplot(df, aes(df$TOASO_Price, df$KCHOL_Price)) +
geom_count(color="darkred") +
geom_smooth(method="lm", se=F,color="blue")
knitr::opts_chunk$set(echo = T,
results = "hide")
library(ggthemes)
library(Hmisc)
library(gridExtra)
library(GGally)
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(corrgram)
library(corrplot)
library(date)
library(readxl)
library(knitr)
priceDif <- bist30 %>% select(matches("price")))))
priceDif <- bist30 %>% select(matches("price")))))
priceDif <- bist30 %>% select(matches("price"))
volumeDif <- bist30 %>% select(matches("Volume"))
bist30 <-  apply(priceDif, 2, function (a) a[i] / a[i-1] * 100)
corrplot(corrDif, type = "upper", tl.pos = "td",
method = "circle", tl.cex = 0.5, tl.col = 'black',
order = "hclust", diag = FALSE)
priceDif <- bist30 %>% select(matches("price"))
priceDif <- bist30 %>% select(matches("price"))
priceDif <- bist30 %>% select(matches("Price"))
priceDif <- bist30 %>% select(matches("Price"))
knitr::opts_chunk$set(echo = T,
results = "hide")
library(ggthemes)
library(Hmisc)
library(gridExtra)
library(GGally)
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(corrgram)
library(corrplot)
library(date)
library(readxl)
library(knitr)
priceDif <- bist30 %>% select(matches("Price"))
priceDif <- bist30 %>% select(matches("Price"))
priceDif <- bist30 %>% select(matches("Price"))
priceDif <- bist30 %>% select(matches("Price"))
priceDif <- bist30[0:61] %>% select(matches("Price"))
priceDif <- bist30[1:61] %>% select(matches("Price"))
priceDif <- bist30[1:61] %>% select(matches("Price"))
priceDif <- bist30[2:61] %>% select(matches("Price"))
priceDif <- bist30[2:61] %>% select(matches("Price"))
priceDif <- bist30[2:61] %>% select(matches("Price"))
priceDif <- bist30[2:61] %>% select(matches("Price"))
priceDif <- bist30[2:60] %>% select(matches("Price"))
priceDif <- bist30[2:60] %>% select(matches("Price"))
df1 <- head(bist30,n= 90)
df2 <- tail(bist30,n= 90)
averageFirst <- df1[0:61] %>% summarise_at(names(df1[0:61]), mean, na.rm = TRUE) %>%
select(matches("price"))
df1 <- head(bist30,n= 90)
df2 <- tail(bist30,n= 90)
averageFirst <- df1[0:61] %>% summarise_at(names(df1[0:61]), mean, na.rm = TRUE) %>%
select(matches("price"))
priceDif <- bist30[3:60] %>% select(matches("^price$"))
priceDif <- bist30[3:60] %>% select(matches("^price$"))
priceDif <- bist30 %>% select(matches(""))
priceDif <- as.numeric(bist30) %>% select(matches(""))
priceDif <- bist30 %>% select(matches(""))
df1 <- head(bist30,n= 90)
df2 <- tail(bist30,n= 90)
averageFirst <- df1[0:61] %>% summarise_at(names(df1[0:61]), mean, na.rm = TRUE) %>%
select(matches("price"))
df1 <- head(bist30,n= 90)
df2 <- tail(bist30,n= 90)
averageFirst <- df1[0:61] %>% summarise_at(names(df1[0:61]), mean, na.rm = TRUE) %>%
select(matches("price"))
knitr::opts_chunk$set(echo = T,
results = "hide")
library(ggthemes)
library(Hmisc)
library(gridExtra)
library(GGally)
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(corrgram)
library(corrplot)
library(date)
library(readxl)
library(knitr)
df1 <- head(bist30,n= 90)
df2 <- tail(bist30,n= 90)
averageFirst <- df1[0:61] %>% summarise_at(names(df1[0:61]), mean, na.rm = TRUE) %>%
select(matches("price"))
df1 <- head(bist30,n= 90)
df2 <- tail(bist30,n= 90)
averageFirst <- df1[0:61] %>% summarise_at(names(df1[0:61]), mean, na.rm = TRUE) %>%
select(matches("price"))
df1 <- head(bist30,n= 90)
df2 <- tail(bist30,n= 90)
averageFirst <- df1[0:61] %>% summarise_at(names(df1[0:61]), mean, na.rm = TRUE) %>%
select(matches("price"))
knitr::opts_chunk$set(echo = T,
results = "hide")
library(ggthemes)
library(Hmisc)
library(gridExtra)
library(GGally)
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(corrgram)
library(corrplot)
library(date)
library(readxl)
library(knitr)
corrValuesPrices <- cor(bist30[62:90],bist30[62:90])
corrplot(corrValuesPrices, method = "number")
corrplot(corrValuesPrices, method = "number")
corrValuesPrices <- cor(bist30[62:90],bist30[62:90])
corrValuesPrices <- cor(bist30[62:90],bist30[62:90])
corrplot(corrValuesPrices, method = "number")
corrValuesPrices <- cor(bist30[62:90],bist30[62:90])
corrValuesPrices <- cor(bist30[62:90],bist30[62:90])
corrplot(corrValuesPrices, method = "number")
knitr::opts_chunk$set(echo = T,
results = "hide")
library(ggthemes)
library(Hmisc)
library(gridExtra)
library(GGally)
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(corrgram)
library(corrplot)
library(date)
library(readxl)
library(knitr)
corrplot(corrValuesPrices, type = "upper", tl.pos = "td",
method = "circle", tl.cex = 0.5, tl.col = 'black',
order = "hclust", diag = FALSE)
ggpairs(df,
columns = c("KRDMD_Price","KRDMD_Volume","ASELS_Price","ASELS_Volume","ASYAB_Price","ASYAB_Volume","TTKOM_Price","TTKOM_Volume","HALKB_Price","HALKB_Volume"),
upper = list(continuous = wrap("cor",
size = 10)),
lower = list(continuous = "smooth"))
corrData<-rcorr(as.matrix(df[,2:60]))
generalCorData <- flattenCorrMatrix(corrData$r, corrData$P)
generalCorData
generalCorData$Names <- paste(generalCorData$row,generalCorData$column,sep= "&")
corrData<-rcorr(as.matrix(df[,2:60]))
generalCorData <- flattenCorrMatrix(corrData$r, corrData$P)
generalCorData
generalCorData$Names <- paste(generalCorData$row,generalCorData$column,sep= "&")
corrData<-rcorr(as.matrix(df[,2:60]))
generalCorData <- flattenCorrMatrix(corrData$r, corrData$P)
generalCorData
generalCorData$Names <- paste(generalCorData$row,generalCorData$column,sep= "&")
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
corrData<-rcorr(as.matrix(df[,2:60]))
generalCorData <- flattenCorrMatrix(corrData$r, corrData$P)
generalCorData
generalCorData$Names <- paste(generalCorData$row,generalCorData$column,sep= "&")
knitr::opts_chunk$set(echo = T,
results = "hide")
library(ggthemes)
library(Hmisc)
library(gridExtra)
library(GGally)
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(corrgram)
library(corrplot)
library(date)
library(readxl)
library(knitr)
df1 <- head(bist30,n= 90)
df2 <- tail(bist30,n= 90)
averageFirst <- df1[0:61] %>% summarise_at(names(df1[0:61]), mean, na.rm = TRUE) %>%
select(matches("price"))
df1 <- head(bist30,n= 90)
df2 <- tail(bist30,n= 90)
averageFirst <- df1[0:61] %>% summarise_at(names(df1[0:61]), mean, na.rm = TRUE) %>%
select(matches("price"))
df1 <- head(bist30,n= 90)
df2 <- tail(bist30,n= 90)
averageFirst <- df1[0:61] %>% summarise_at(names(df1[0:61]), mean, na.rm = TRUE) %>%
select(matches("price"))
corrData<-rcorr(as.matrix(df[,2:60]))
generalCorData <- flattenCorrMatrix(corrData$r, corrData$P)
generalCorData
generalCorData$Names <- paste(generalCorData$row,generalCorData$column,sep= "&")
corrplot(corrValuesPrices, method = "number")
corrValuesPrices <- cor(bist30[62:90],bist30[62:90])
flattenCorrMatrix <- function(cormat, pmat) {
ut <- upper.tri(cormat)
data.frame(
row = rownames(cormat)[row(cormat)[ut]],
column = rownames(cormat)[col(cormat)[ut]],
cor  =(cormat)[ut],
p = pmat[ut]
)
}
corrData<-rcorr(as.matrix(df[,2:60]))
generalCorData <- flattenCorrMatrix(corrData$r, corrData$P)
generalCorData
generalCorData$Names <- paste(generalCorData$row,generalCorData$column,sep= "&")
knitr::opts_chunk$set(echo = T,
results = "hide")
library(ggthemes)
library(Hmisc)
library(gridExtra)
library(GGally)
library(tibble)
library(dplyr)
library(tidyr)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(corrgram)
library(corrplot)
library(date)
library(readxl)
library(knitr)
df
x <- df[,2:60]
corrData<-rcorr(as.matrix(x))
generalCorData <- flattenCorrMatrix(corrData$r, corrData$P)
generalCorData
generalCorData$Names <- paste(generalCorData$row,generalCorData$column,sep= "&")
